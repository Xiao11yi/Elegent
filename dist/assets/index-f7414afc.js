import{_ as q,r,u as D,Z as G,o as T,y as O,A as H,C as J,b as N,c as M,f as a,w as t,d as l,H as c,I as p,K as y,Y as K,m as P,k as W,i as X,t as Y,h as _,l as Z,$ as Q,E as ee,X as ae,M as se,N as le,a0 as oe,v as te,x as ne}from"./index-08731fde.js";/* empty css                     *//* empty css                 *//* empty css                 *//* empty css                    */import{a as re,g as ue}from"./userInfo-66ebaf95.js";const m=f=>(te("data-v-db5ddf00"),f=f(),ne(),f),de={class:"user-info-card"},ie={class:"user-avatar"},ce=["src"],pe={class:"showSpan"},_e={class:"user-info"},me={class:"user-info-item"},ve=m(()=>l("span",{class:"user-info-label"},"用户名",-1)),fe={class:"user-info-value"},ge={class:"user-info-item"},be=m(()=>l("span",{class:"user-info-label"},"昵称",-1)),he={class:"user-info-item"},ye=m(()=>l("span",{class:"user-info-label"},"性别",-1)),ke={class:"user-info-item"},xe=m(()=>l("span",{class:"user-info-label"},"个性签名",-1)),Ve={class:"user-info-item"},Ie=m(()=>l("span",{class:"user-info-label"},"电子邮箱",-1)),Ee={class:"user-info-item"},Ne=m(()=>l("span",{class:"user-info-label"},"手机号码",-1)),we={class:"card-footer"},Se={__name:"index",setup(f){const k=r(!1);r(!1),D();const u=r(!0);r();const s=r({}),d=r(!1),x=r(!1),V=r(),$=G({nickName:[{required:!0,message:"昵称不能为空",trigger:"blur"}],email:[{type:"email",required:!1,message:"邮箱格式错误",trigger:"blur"}],phonenumber:[{required:!1,message:"手机号码格式错误",trigger:"blur",pattern:/(^((\+86)|(86))?(1[3-9])\d{9}$)|(^(0\d{2,3})-?(\d{7,8})$)/}]}),z=o=>{o&&o.validate(e=>{if(!e){y.error("填写的个人信息有点小问题哦~");return}re(s.value.nickName,s.value.sex,s.value.email,s.value.remark,s.value.phonenumber).then(i=>{I(),y({message:"更新个人信息成功",type:"success"}),location.reload(),u.value=!0,d.value=!1})})},B=()=>{V.value.clearValidate(),I(),u.value=!0,d.value=!1},I=()=>{ue().then(o=>{s.value=o.data}).catch(o=>{console.log(o)})};T(()=>{I()});const w=O(),S=r({delName:"../../../assets/images/bg.png"}),C=r({Authorization:"Bearer "+H()}),g=r(""),U=()=>w.state.user.avatar;g.value=U();const F=(o,e)=>{w.dispatch("SetAvatar",o.data.fileName).then(i=>{}).catch(i=>console.error(i)),S.value.delName=o.data.fileName},R=o=>{const e=["jpeg","jpg","png"],i=o.type.split("/")[1],E=o.size/1024/1024;return e.indexOf(i)===-1?(y.error("必须是JPG/png/jpeg格式!"),!1):E>4?(y.error("不能超过2MB!"),!1):!0};return J(U,(o,e)=>{g.value=o},{immediate:!0}),(o,e)=>{const i=Z,E=Q,b=ee,v=ae,A=se,L=le,j=K,h=P;return N(),M("div",de,[a(j,{ref_key:"ruleFormRef",ref:V,model:s.value,rules:$,"label-width":"0px",class:"login-ruleForm"},{default:t(()=>[c(l("div",ie,[a(E,{class:"avatar-uploader",action:"/dev-api/common/upLoad/userAvatar","show-file-list":!1,headers:C.value,data:S.value,"on-success":F,"before-upload":R},{default:t(()=>[g.value?(N(),M("img",{key:0,src:g.value,class:"avatar",onMouseenter:e[0]||(e[0]=n=>k.value=!0),onMouseleave:e[1]||(e[1]=n=>k.value=!1)},null,40,ce)):(N(),W(i,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[a(X(oe))]),_:1}))]),_:1},8,["headers","data"]),c(l("span",pe,"点击修改头像",512),[[p,k.value]])],512),[[p,x.value]]),l("div",_e,[l("div",me,[ve,l("span",fe,Y(s.value.userName),1)]),l("div",ge,[be,a(v,{prop:"nickName"},{default:t(()=>[a(b,{modelValue:s.value.nickName,"onUpdate:modelValue":e[2]||(e[2]=n=>s.value.nickName=n),class:"w-50 m-3",size:"large",placeholder:"请输入昵称",disabled:u.value},null,8,["modelValue","disabled"])]),_:1})]),l("div",he,[ye,a(v,{prop:"sex"},{default:t(()=>[a(L,{modelValue:s.value.sex,"onUpdate:modelValue":e[3]||(e[3]=n=>s.value.sex=n),disabled:u.value},{default:t(()=>[a(A,{label:"0",value:"0"},{default:t(()=>[_("男")]),_:1}),a(A,{label:"1",value:"1"},{default:t(()=>[_("女")]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})]),l("div",ke,[xe,a(v,{prop:"remark"},{default:t(()=>[a(b,{modelValue:s.value.remark,"onUpdate:modelValue":e[4]||(e[4]=n=>s.value.remark=n),class:"w-50 m-3",size:"large",placeholder:"用一句话来介绍下自己吧",disabled:u.value},null,8,["modelValue","disabled"])]),_:1})]),l("div",Ve,[Ie,a(v,{prop:"email"},{default:t(()=>[a(b,{modelValue:s.value.email,"onUpdate:modelValue":e[5]||(e[5]=n=>s.value.email=n),type:"email",class:"w-50 m-3",size:"large",placeholder:"请输入电子邮箱",disabled:u.value},null,8,["modelValue","disabled"])]),_:1})]),l("div",Ee,[Ne,a(v,{prop:"phonenumber"},{default:t(()=>[a(b,{modelValue:s.value.phonenumber,"onUpdate:modelValue":e[6]||(e[6]=n=>s.value.phonenumber=n),class:"w-50 m-3",size:"large",placeholder:"请输入手机号码",disabled:u.value},null,8,["modelValue","disabled"])]),_:1})])])]),_:1},8,["model","rules"]),l("div",we,[c(a(h,{type:"primary",color:"#1892ff",onClick:e[7]||(e[7]=n=>(u.value=!1,d.value=!d.value))},{default:t(()=>[_("修改信息")]),_:1},512),[[p,!d.value]]),c(a(h,{type:"primary",color:"#1892ff",onClick:e[8]||(e[8]=n=>x.value=!x.value)},{default:t(()=>[_("修改头像")]),_:1},512),[[p,!d.value]]),c(a(h,{type:"primary",color:"#1892ff",onClick:e[9]||(e[9]=n=>z(V.value))},{default:t(()=>[_("保存")]),_:1},512),[[p,d.value]]),c(a(h,{onClick:B},{default:t(()=>[_("取消")]),_:1},512),[[p,d.value]])])])}}},Ce=q(Se,[["__scopeId","data-v-db5ddf00"]]);export{Ce as default};
